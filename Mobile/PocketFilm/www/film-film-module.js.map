{"version":3,"sources":["webpack:///./src/app/film/film.module.ts","webpack:///./src/app/film/film.page.html","webpack:///./src/app/film/film.page.scss","webpack:///./src/app/film/film.page.ts"],"names":[],"mappings":"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","file":"film-film-module.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\nimport {VgCoreModule} from 'videogular2/core';\nimport {VgControlsModule} from 'videogular2/controls';\nimport {VgOverlayPlayModule} from 'videogular2/overlay-play';\nimport {VgBufferingModule} from 'videogular2/buffering';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { FilmPage } from './film.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: FilmPage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    VgCoreModule,\n    VgControlsModule,\n    VgOverlayPlayModule,\n    VgBufferingModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [FilmPage]\n})\nexport class FilmPageModule {}\n","module.exports = \"<ion-header>\\n  <ion-toolbar color=\\\"danger\\\">\\n    <ion-title style=\\\"text-align: center;\\\">{{typeNameList[type]}}</ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content>\\n\\n  <!-- 下拉刷新 -->\\n  <ion-refresher (ionRefresh)=\\\"doRefresh($event)\\\">\\n    <ion-refresher-content pullingIcon=\\\"arrow-dropdown\\\" pullingText=\\\"松开刷新\\\" refreshingSpinner=\\\"circles\\\"\\n      refreshingText=\\\"正在刷新\\\">\\n    </ion-refresher-content>\\n  </ion-refresher>\\n  <!-- 下拉刷新 -->\\n\\n  <!-- 搜索 -->\\n  <ion-searchbar (click)=\\\"goSearchMovie()\\\" placeholder=\\\"请输入影视或演员名称\\\"></ion-searchbar>\\n\\n  <ion-segment scrollable [(ngModel)]=\\\"type\\\">\\n    <ion-segment-button value=\\\"0\\\" (click)=\\\"changeMovieType(0)\\\">\\n      全部\\n    </ion-segment-button>\\n    <ion-segment-button value=\\\"1\\\" (click)=\\\"changeMovieType(1)\\\" *ngIf=\\\"recommendations.length != 0\\\">\\n      推荐\\n    </ion-segment-button>\\n    <ion-segment-button value=\\\"2\\\" (click)=\\\"changeMovieType(2)\\\">\\n      电影\\n    </ion-segment-button>\\n    <ion-segment-button value=\\\"3\\\" (click)=\\\"changeMovieType(3)\\\">\\n      电视剧\\n    </ion-segment-button>\\n    <ion-segment-button value=\\\"4\\\" (click)=\\\"changeMovieType(4)\\\">\\n      综艺\\n    </ion-segment-button>\\n    <ion-segment-button value=\\\"5\\\" (click)=\\\"changeMovieType(5)\\\">\\n      动漫\\n    </ion-segment-button>\\n    <ion-segment-button value=\\\"6\\\" (click)=\\\"changeMovieType(6)\\\">\\n      少儿\\n    </ion-segment-button>\\n  </ion-segment>\\n\\n  <!-- 全部、推荐 -->\\n  <section class=\\\"main\\\" *ngIf=\\\"type <= 1\\\">\\n    <div id=\\\"page\\\">\\n    </div>\\n    <div class=\\\"mod_a globalPadding\\\">\\n      <div class=\\\"tb_a\\\">\\n        <ul class=\\\"picTxt picTxtA clearfix\\\" id=\\\"data_list\\\">\\n          <li *ngFor=\\\"let latestTop10Movie of latestTop10Movies\\\" (click)=\\\"goMovieDetail((latestTop10Movie._id))\\\">\\n            <div class=\\\"con\\\">\\n              <a title=\\\"{{latestTop10Movie.name}}\\\"><img data-src=\\\"{{latestTop10Movie.src}}\\\"\\n                  alt=\\\"{{latestTop10Movie.name}}\\\" src=\\\"{{latestTop10Movie.src}}\\\"\\n                  onerror=\\\"onerror=null;src='https://m.88ys.cc/images/load.gif'\\\"\\n                  style=\\\"width: 158px; height: 159px; display: block;\\\"><span class=\\\"sNum\\\"><em\\n                    class=\\\"emScore\\\">{{latestTop10Movie.update_status}}</em></span> <span\\n                  class=\\\"sTit\\\">{{latestTop10Movie.name}}</span> </a>\\n            </div>\\n          </li>\\n        </ul>\\n      </div>\\n    </div>\\n  </section>\\n\\n  <!-- 电影、电视剧、综艺、动漫 -->\\n  <section class=\\\"main\\\" *ngIf=\\\"type > 1\\\">\\n    <div id=\\\"page\\\">\\n    </div>\\n\\n    <!-- 最热影视 -->\\n    <div class=\\\"mod_a globalPadding\\\">\\n      <div class=\\\"th_a\\\"><span class=\\\"sMark\\\"><i class=\\\"iPoint\\\"></i>最热{{typeNameList[type]}}</span><span class=\\\"span-more\\\"\\n          (click)=\\\"goMoreMovie(2)\\\">更多</span></div>\\n      <div class=\\\"tb_a\\\">\\n        <ul class=\\\"picTxt picTxtA clearfix\\\" id=\\\"data_list\\\">\\n          <li *ngFor=\\\"let latestTop10Movie of hottestTop10Movies\\\" (click)=\\\"goMovieDetail((latestTop10Movie._id))\\\">\\n            <div class=\\\"con\\\">\\n              <a title=\\\"{{latestTop10Movie.name}}\\\"><img data-src=\\\"{{latestTop10Movie.src}}\\\"\\n                  alt=\\\"{{latestTop10Movie.name}}\\\" src=\\\"{{latestTop10Movie.src}}\\\"\\n                  onerror=\\\"onerror=null;src='https://m.88ys.cc/images/load.gif'\\\"\\n                  style=\\\"width: 158px; height: 159px; display: block;\\\"><span class=\\\"sNum\\\"><em\\n                    class=\\\"emScore\\\">{{latestTop10Movie.update_status}}</em></span> <span\\n                  class=\\\"sTit\\\">{{latestTop10Movie.name}}</span> </a>\\n            </div>\\n          </li>\\n        </ul>\\n      </div>\\n    </div>\\n\\n    <!-- 最新影视 -->\\n    <div class=\\\"mod_a globalPadding\\\">\\n      <div class=\\\"th_a\\\"><span class=\\\"sMark\\\"><i class=\\\"iPoint\\\"></i>最新{{typeNameList[type]}}</span><span class=\\\"span-more\\\"\\n          (click)=\\\"goMoreMovie(1)\\\">更多</span></div>\\n      <div class=\\\"tb_a\\\">\\n        <ul class=\\\"picTxt picTxtA clearfix\\\" id=\\\"data_list\\\">\\n          <li *ngFor=\\\"let latestTop10Movie of latestTop10Movies\\\" (click)=\\\"goMovieDetail((latestTop10Movie._id))\\\">\\n            <div class=\\\"con\\\">\\n              <a title=\\\"{{latestTop10Movie.name}}\\\"><img data-src=\\\"{{latestTop10Movie.src}}\\\"\\n                  alt=\\\"{{latestTop10Movie.name}}\\\" src=\\\"{{latestTop10Movie.src}}\\\"\\n                  onerror=\\\"onerror=null;src='https://m.88ys.cc/images/load.gif'\\\"\\n                  style=\\\"width: 158px; height: 159px; display: block;\\\"><span class=\\\"sNum\\\"><em\\n                    class=\\\"emScore\\\">{{latestTop10Movie.update_status}}</em></span> <span\\n                  class=\\\"sTit\\\">{{latestTop10Movie.name}}</span> </a>\\n            </div>\\n          </li>\\n        </ul>\\n      </div>\\n    </div>\\n  </section>\\n\\n  <!-- 上拉加载更多 -->\\n  <ion-infinite-scroll (ionInfinite)=\\\"doLoadMore($event)\\\" *ngIf=\\\"type == 0\\\">\\n      <ion-infinite-scroll-content loadingSpinner=\\\"bubbles\\\" loadingText=\\\"正在加载\\\">\\n      </ion-infinite-scroll-content>\\n    </ion-infinite-scroll>\\n    <!-- 上拉加载更多 -->\\n\\n</ion-content>\"","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2ZpbG0vZmlsbS5wYWdlLnNjc3MifQ== */\"","import { Component, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\n\nimport { StorageService } from '../storage.service';\nimport { ToolsService } from '../tools.service';\nimport { reject } from 'q';\n\n@Component({\n  selector: 'app-film',\n  templateUrl: './film.page.html',\n  styleUrls: ['./film.page.scss'],\n})\nexport class FilmPage implements OnInit {\n\n  // 推荐数据\n  public recommendations = []\n  // 最新排名前10的电影\n  public latestTop10Movies = []\n  // 最热排名前10的电影\n  public hottestTop10Movies = []\n\n  // 影视类型\n  public type = 0\n  // 影视类型名称列表\n  public typeNameList = ['全部', '推荐', '电影', '电视剧', '综艺', '动漫', '少儿'];\n  // 每行电影的数量\n  public col_size = 4\n  public source_index = 0;\n  public type_index = 0;\n  // 浏览类型\n  public browse_type = 'movie'\n\n  // 影视选中二级类型列表\n  public selectTypeList = null\n  // 当前页码\n  public pageIndex = 1\n  // 每页大小\n  public pageSize = 9\n  // 关键词\n  public keyWord = 'null'\n\n  constructor(\n    public storage: StorageService,\n    public tools: ToolsService,\n    public router: Router) {\n    // 清空缓存\n    this.clearCache()\n    // 获取影视列表\n    this.getMovies()\n    // 检查更新\n    this.tools.checkForUpdates(0)\n  }\n\n  ngOnInit() {\n  }\n\n  /**\n   * 获取影视列表\n   */\n\n  getMovies() {\n    // 获取推荐数据\n    this.getRecommendations().then((data: any) => {\n      this.recommendations = data\n      if (this.type == 0) {\n        // 全部\n        this.getTop10Movies('全部', 0).then((data: any) => {\n          this.latestTop10Movies = this.latestTop10Movies.concat(data)\n        })\n      } else if (this.type == 1) {\n        // 推荐\n        this.latestTop10Movies = this.recommendations\n      } else {\n        this.getTop10Movies(this.type - 2, 2).then((data: any) => {\n          this.hottestTop10Movies = data\n        })\n        this.getTop10Movies(this.type - 2, 0).then((data: any) => {\n          this.latestTop10Movies = data\n        })\n      }\n    })\n  }\n\n  /**\n   * 获取推荐数据\n   */\n\n  getRecommendations() {\n    var promise = new Promise((resolve, error) => {\n      var recommendations = this.storage.get('movie-recommendations')\n      if (recommendations == null || recommendations.length == 0) {\n        // 本地没有推荐数据的缓存\n        this.tools.getRecommendationsByUserApi(this.browse_type, this.typeNameList[this.type]).then((data: any) => {\n          var top10Movies = []\n          var latestTop10MoviesTemp = []\n          latestTop10MoviesTemp = data.data\n          if (latestTop10MoviesTemp.length > 0 && latestTop10MoviesTemp[0].euclidean == null) {\n            // 用户没有登陆时获取到的推荐数据\n            top10Movies = latestTop10MoviesTemp\n          } else {\n            // 用户没有登陆后获取到的推荐数据\n            latestTop10MoviesTemp.forEach((data: any) => {\n              var movie = data.movie[0]\n              top10Movies.push(movie)\n            })\n          }\n          // 将推荐数据缓存到本地\n          this.storage.set('movie-recommendations', top10Movies)\n          resolve(top10Movies)\n        })\n      } else {\n        // 本地有推荐数据的缓存\n        resolve(recommendations)\n      }\n    })\n    return promise\n  }\n\n  /**\n   * 获取最新排名前10的影视\n   * @param type 影视类型 0：电影 1：电视剧 2：综艺 3：动漫\n   */\n\n  getTop10Movies(type, sortType): any {\n    var promise = new Promise((resolve, reject) => {\n      var storageName = ''\n      if (type == '全部') {\n        storageName = 'movie-all'\n      } else {\n        storageName = 'movie-' + type + '-' + sortType\n      }\n      var movies = this.storage.get(storageName)\n      if (movies == null || movies.length == 0 || this.pageIndex > (movies.length / this.pageSize)) {\n        // 本地没有相应的缓存\n        this.tools.getMovieListApi(type, this.selectTypeList, this.pageIndex, this.pageSize, sortType, this.keyWord).then((data: any) => {\n          if (data.code == 0) {\n            var top10Movies = data.data\n            this.storage.set(storageName, top10Movies)\n            resolve(top10Movies)\n          }\n        })\n      } else {\n        // 本地有相应的缓存\n        resolve(movies)\n      }\n    })\n    return promise\n  }\n\n  /**\n   * 跳转到影视详情页\n   * @param _id 影视_id\n   */\n\n  goMovieDetail(_id) {\n    //  跳转到影视详情页\n    this.router.navigate(['/movie-detail'], {\n      queryParams: {\n        _id: _id\n      }\n    })\n  }\n\n  /**\n   * 跳转到更多推荐页\n   */\n\n  goMoreRecommendations() {\n    this.router.navigate(['/more-recommend-movie'], {\n      queryParams: {\n        type: this.type\n      }\n    })\n  }\n\n  /**\n   * 跳转到更多影视页\n   * @param sortType  排序方式 0、1：发布日期 2：评分\n   */\n\n  goMoreMovie(sortType) {\n    this.router.navigate(['/more-movie'], {\n      queryParams: {\n        type: this.type - 2,\n        sortType: sortType\n      }\n    })\n  }\n\n  /**\n   * 跳转到搜索影视页\n   */\n\n  goSearchMovie() {\n    this.router.navigate(['/search-movie'])\n  }\n\n  /**\n   * 下拉刷新\n   * @param event 事件对象\n   */\n\n  doRefresh(event) {\n    // 清空缓存\n    this.clearCache()\n    // 清空影视列表数据\n    this.recommendations = []\n    this.latestTop10Movies = []\n    this.hottestTop10Movies = []\n    // 修改当前页码\n    this.pageIndex = 1\n    // 获取影视列表\n    this.getMovies()\n    if (event) {\n      //告诉ionic 刷新数据完成\n      event.target.complete();\n    }\n  }\n\n  /**\n   * 上拉加载更多\n   * @param event 事件对象\n   */\n\n  doLoadMore(event) {\n    // 将当前页码加1\n    this.pageIndex = this.pageIndex + 1\n    // 获取影视列表\n    this.getMovies()\n    if (event) {\n      //告诉ionic 刷新数据完成\n      event.target.complete();\n    }\n  }\n\n  /**\n   * 改变影视类型\n   * @param i 一级分类序号\n   * @param j 二级分类序号\n   */\n\n  changeMovieType(type) {\n    // 清空影视列表数据\n    this.latestTop10Movies = []\n    this.hottestTop10Movies = []\n    // 修改当前页码为1\n    this.pageIndex = 1\n    // 修改影视类型\n    this.type = type\n    // 获取影视列表\n    this.getMovies()\n  }\n\n  /**\n   * 清空缓存\n   */\n\n  clearCache() {\n    // 清空对应的缓存数据\n    this.storage.set('movie-all', [])\n    if (this.type == 0 || this.type == 1) {\n      // 当在全部、推荐页面刷新时更新推荐数据，其他页面刷新时不更新推荐数据\n      this.storage.set('movie-recommendations', [])\n    }\n    this.storage.set('movie-' + this.type + '-1', [])\n    this.storage.set('movie-' + this.type + '-2', [])\n  }\n\n}\n"],"sourceRoot":""}